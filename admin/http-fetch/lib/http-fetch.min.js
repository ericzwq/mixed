function asyncGeneratorStep(e,t,n,r,o,a,u){try{var s=e[a](u),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){asyncGeneratorStep(a,r,o,u,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,u,s,"throw",e)}u(void 0)}))}}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).FetchJs={})}(this,(function(e){"use strict";function t(e,t,o,a){return r(n(Promise.resolve(a),e).then((function(e){return t(a=e)})),o,a)}function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r===t.length?e:n(e.then(t[r],t[++r]),t,r+1)}function r(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(o===t.length)return e;var a=t[o];return r(e.then((function(e){return"function"==typeof a?a(e,n):e}),t[++o]),t,n,o+1)}var o;!function(e){e.json="application/json",e.formData="multipart/form-data",e.urlencoded="application/x-www-from-urlencoded"}(o||(o={}));var a="production"===process.env.NODE;function u(e){if("object"!==_typeof(e))return e;if(Array.isArray(e))return e.map(u);var t={};return Object.keys(e).forEach((function(n){return t[n]=u(e[n])})),t}function s(e){var t=c(e);return(t="&"===t[0]?t.slice(1):t)?"?"+t:""}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"object"===_typeof(e)?null!=e?Object.keys(e).reduce((function(t,n){return t+(null!=e[n]?"&"+n+"="+c(e[n]):"")}),t):t:t+e}function i(e,t,n,r){t.config=n,t.response=r,r?r.clone().text().then((function(n){try{n=JSON.parse(n)}catch(e){}t.data=n,e(t)})):e(t)}function f(e){!a&&e.signal&&console.error("[HttpFetch warn]: If you want to abort request, please use controller instead signal."),e.method&&(e.method=e.method.toUpperCase());var t=e.data,n=e.params,r="";null!=n&&(r=s(n)),null!=t&&(["Object","Array","Boolean","Number","Null"].includes(Object.prototype.toString.call(t).slice(8,-1))?(e.body=JSON.stringify(t),e.headers["Content-Type"]||(e.headers["Content-Type"]=o.json)):e.body=t);var u=e.controller||new AbortController;e.signal=u.signal;var c=""+e.url;return c.startsWith("http")||c.startsWith("//")||!e.base||(c=e.base+c),new Promise(function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(n,o){var a,s,f,p,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.timeout&&setTimeout((function(){return l(u,o,e)}),e.timeout),t.prev=1,t.next=4,fetch(c+r,e);case 4:if((a=t.sent).ok){t.next=7;break}return t.abrupt("return",i(o,new Error("Fetch failed with status "+a.status),e,a));case 7:a.body?(s=a.body.getReader(),f=+(a.headers.get("Content-Length")||0),p={total:f,loaded:0},d=new ReadableStream({start:function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(r){var a,u,c,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0;case 1:return t.next=4,s.read();case 4:if(a=t.sent,u=a.done,c=a.value,!u){t.next=9;break}return t.abrupt("break",14);case 9:r.enqueue(c),p.loaded+=c.length,e.onDownloadProgress&&e.onDownloadProgress(p),t.next=1;break;case 14:t.next=19;break;case 16:return t.prev=16,t.t0=t.catch(0),t.abrupt("return",i(o,t.t0,e));case 19:if(r.close(),"stream"!==e.responseType){t.next=22;break}return t.abrupt("return",n(d));case 22:if(t.prev=22,!["json","blob","text","arrayBuffer","formData"].includes(e.responseType)){t.next=29;break}return t.next=26,new Response(d)[e.responseType]();case 26:f=t.sent,t.next=33;break;case 29:return t.next=31,new Response(d).text();case 31:f=t.sent;try{f=JSON.parse(f)}catch(e){}case 33:t.next=38;break;case 35:return t.prev=35,t.t1=t.catch(22),t.abrupt("return",i(o,new Error("Response parse error"),e));case 38:n(f);case 39:case"end":return t.stop()}}),t,null,[[0,16],[22,35]])})));return function(e){return t.apply(this,arguments)}}()})):n(null),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),i(o,t.t0,e);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}function l(e,t,n){e.abort(),i(t,new Error("Timeout of ".concat(n.timeout,"ms exceeded")),n)}function p(e){var n,r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n="string"==typeof e?e:(o=e).url,Object.keys(this.config).forEach((function(e){return e in o?0:o[e]=u(r.config[e])})),o.url=n,t(this.interceptors.request.handlers,f,this.interceptors.response.handlers,o)}var d=function e(t,n){return p.call(e,t,n)};d.config={timeout:0,headers:{}},d.interceptors={request:{use:function(e,t){return this.handlers.push(e,t)},handlers:[]},response:{use:function(e,t){return this.handlers.push(e,t)},handlers:[]}},d.create=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=function e(t,n){return p.call(e,t,n)};return Object.keys(this).forEach((function(t){if("create"!==t){var r=e[t];n[t]=r}})),Object.keys(this.config).forEach((function(n){return n in t?0:t[n]=u(e.config[n])})),n.config=t,n},["post","put","patch"].forEach((function(e){d[e]=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.method=e,r.data=n,p.call(this,t,r)}})),["get","delete","options","head"].forEach((function(e){d[e]=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.method=e,r.params=n,p.call(this,t,r)}})),e.default=d,Object.defineProperty(e,"__esModule",{value:!0})}));
